\chapter{\IFRU{Уровень}{Level} 3}

\IFRU{Для решения задач третьего уровня вам придется потратить какое-то ощутимое время, 
вплоть до одного дня}
{For solving level 3 tasks, you'll probably need considerable ammount of time, maybe up to one day}.

\section{\Exercise 3.1}

\IFRU{Довольно известный алгоритм, так же включен в стандартную библиотеку Си. Исходник взят из glibc 2.11.1. 
Скомпилирован в GCC 4.4.1 с ключом \TT{-Os} (оптимизация по размеру кода). 
Листинг сделан дизассемблером IDA 4.9 из ELF-файла созданным GCC и линкером.}
{Well-known algorithm, also included in standard C library. Source code was taken from glibc 2.11.1.
Compiled in GCC 4.4.1 with \TT{-Os} option (code size optimization).
Listing was done by IDA 4.9 disassembler from ELF-file generated by GCC and linker.}

\IFRU{Для тех кто хочет использовать IDA в процессе изучения, вот здесь лежат .elf и .idb файлы, 
.idb можно открыть при помощи бесплатной IDA 4.9:}
{For those who wants use IDA while learning, here you may find .elf and .idb files,
.idb can be opened with freeware IDA 4.9:}

\url{http://yurichev.com/RE-exercises/3/1/}

\lstinputlisting{exercises/2_1_gcc.asm}

\section{\Exercise 3.2}

\IFRU{Имеется небольшой исполняемый файл, внутри которого находится довольно известная криптосистема}
{There is a small executable file with a well-known cryptosystem inside}.
\IFRU{Попробуйте её идентифицировать}{Try to identify it}.

\begin{itemize}
\item
\href{http://yurichev.com/RE-exercises/3/2/unknown_cryptosystem.exe}{Windows x86}

\item
\href{http://yurichev.com/RE-exercises/3/2/unknown_encryption_linux86.tar}{Linux x86}

\item
\href{http://yurichev.com/RE-exercises/3/2/unknown_encryption_MacOSX.tar}{MacOSX (x64)}
\end{itemize}

\section{\Exercise 3.3}

\IFRU{Имеется небольшой исполняемый файл, некая утилита}
{There is a small executable file, some utility}.
\IFRU{Она открывает другой файл, читает его, что-то вычисляет и показывает число с плавающей точкой}
{It opens another file, reads it, calculate something and prints a float number}.
\IFRU{Попробуйте разобраться, что она делает}{Try to understand what it do}.

\begin{itemize}
\item
\href{http://yurichev.com/RE-exercises/3/3/unknown_utility_2_3.exe}{Windows x86}

\item
\href{http://yurichev.com/RE-exercises/3/3/unknown_utility_2_3_Linux86.tar}{Linux x86}

\item
\href{http://yurichev.com/RE-exercises/3/3/unknown_utility_2_3_MacOSX.tar}{MacOSX (x64)}
\end{itemize}

\section{\Exercise 3.4}

\IFRU{Утилита, шифрующая и дешифрующая файлы, по паролю}
{There is an utility which encrypts/decrypts files, by password}.
\IFRU{Есть зашифрованный текстовый файл, пароль неизвестен}{There is an encrypted text file,
password is unknown}.
\IFRU{Зашифрованный файл ~--- это текст на английском языке}{Encrypted file is a text in English language}.
\IFRU{Утилита использует сравнительно мощный алгоритм шифрования, тем не менее,
он был применен с очень грубой ошибкой. И из-за ошибки расшифровать файл вполне возможно с минимумом затрат}
{The utility uses relatively strong cryptosystem, nevertheless, it was implemented with a serious blunder.
Since the mistake present, it is possible to decrypt the file with a little effort.}.

\IFRU{Попробуйте найти ошибку и расшифровать файл}{Try to find the mistake and decrypt the file}.

\begin{itemize}
\item
\href{http://yurichev.com/RE-exercises/3/4/amateur_cryptor.exe}{Windows x86}

\item
\href{http://yurichev.com/RE-exercises/3/4/text_encrypted}{\IFRU{Текстовый файл}{Text file}}
\end{itemize}

\section{\Exercise 3.5}

\IFRU{Это имитация защиты от копирования использующей ключевой файл}
{This is software copy protection imitation, which uses key file}.
\IFRU{В ключевом файле имя пользователя и серийный номер}
{The key file contain user (or customer) name and serial number}.

\IFRU{Задачи две}{There are two tasks}:

\begin{itemize}
\item
\IFRU{(Простая) при помощи \tracer либо иного отладчика, 
заставьте эту программу принимать измененный ключевой файл}{(Easy) with the help of \tracer
or any other debugger, force the program to accept changed key file}.

\item
\IFRU{(Средняя) ваша задача заключается в том, чтобы изменить в файле имя пользователя на другое, 
но при этом, модифицировать саму программу нельзя}
{(Medium) your goal is to modify user name to another, however, it is not allowed to patch the program}.
\end{itemize}

\begin{itemize}
\item
\href{http://yurichev.com/RE-exercises/3/5/super_mega_protection.exe}{Windows x86}

\item
\href{http://yurichev.com/RE-exercises/3/5/super_mega_protection.tar}{Linux x86}

\item
\href{http://yurichev.com/RE-exercises/3/5/super_mega_protection_MacOSX.tar}{MacOSX (x64)}

\item
\href{http://yurichev.com/RE-exercises/3/5/sample.key}{\IFRU{Ключевой файл}{Key file}}
\end{itemize}

\section{\Exercise 3.6}

\IFRU{Это очень примитивный игрушечный веб-сервер, поддерживающий только статические файлы, без \ac{CGI}, и т.д}
{Here is a very primitive toy web-server, supporting only static files, without \ac{CGI}, etc}.
\IFRU{В нем сознательно оставлено по крайней мере 4 уязвимости}
{At least 4 vulnerabilities are leaved here intentionally}.
\IFRU{Постарайтесь найти их все и использовать для взлома удаленной машины}
{Try to find them all and exploit them in order for breaking into a remote host}.

\begin{itemize}
\item
\href{http://yurichev.com/RE-exercises/3/6/webserv_win32.rar}{Windows x86}

\item
\href{http://yurichev.com/RE-exercises/3/6/webserv_Linux_x86.tar}{Linux x86}

\item
\href{http://yurichev.com/RE-exercises/3/6/webserv_MacOSX_x64.tar}{MacOSX (x64)}
\end{itemize}

\section{\Exercise 3.7}

\IFRU{При помощи \tracer или любого другого win32-отладчика, найдите скрытые мины во время игры,
в стандартной игре Windows MineSweeper}
{With the help of \tracer or any other win32 debugger, reveal hidden mines in the MineSweeper standard Widnows game
during play}.

\IFRU{Подсказка: в}{Hint:} \cite{trew} \IFRU{имеются некоторые описания внутренностей игры MineSweeper}
{have some insights about MineSweeper's internals}.
