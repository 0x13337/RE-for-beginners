%\newcommand*{\TT}[1]{\texttt{#1}}
% synonyms, so far
\newcommand*{\TT}[1]{\colorbox{light-gray}{\texttt{#1}}}
\newcommand*{\GTT}[1]{\colorbox{light-gray}{\texttt{#1}}}
\newcommand*{\IT}[1]{\textit{#1}}
\newcommand*{\EN}[1]{\iflanguage{english}{#1}{}}

\ifdefined\RUSSIAN{}
\newcommand*{\RU}[1]{\iflanguage{russian}{#1}{}}
\else
\newcommand*{\RU}[1]{}
\fi

\ifdefined\SPANISH{}
\newcommand*{\ES}[1]{\iflanguage{spanish}{#1}{}}
\else
\newcommand*{\ES}[1]{}
\fi

\ifdefined\ITALIAN{}
\newcommand*{\ITA}[1]{\iflanguage{italian}{#1}{}}
\else
\newcommand*{\ITA}[1]{}
\fi

\ifdefined\BRAZILIAN{}
\newcommand*{\PTBR}[1]{\iflanguage{portuges}{#1}{}}
\else
\newcommand*{\PTBR}[1]{}
\fi

\ifdefined\POLISH{}
\newcommand*{\PL}[1]{\iflanguage{polish}{#1}{}}
\else
\newcommand*{\PL}[1]{}
\fi

\ifdefined\GERMAN{}
%\newcommand*{\DE}[1]{\iflanguage{german}{#1}{}}
\newcommand*{\DE}[1]{#1}
\else
\newcommand*{\DE}[1]{}
\fi

\ifdefined\THAI{}
\newcommand*{\THA}[1]{\iflanguage{thai}{#1}{}}
\else
\newcommand*{\THA}[1]{}
\fi

\ifdefined\DUTCH{}
\newcommand*{\NL}[1]{\iflanguage{dutch}{#1}{}}
\else
\newcommand*{\NL}[1]{}
\fi

\newcommand{\LANG}{\RU{ru}\EN{en}\ES{es}\PTBR{ptbr}\PL{pl}\ITA{it}\DE{de}\THA{th}\NL{nl}}

\newcommand{\ESph}{\ES{Spanish text placeholder}}
\newcommand{\PTBRph}{\PTBR{Brazilian Portuguese text placeholder}}
\newcommand{\PLph}{\PL{Polish text placeholder}}
\newcommand{\ITAph}{\ITA{Italian text placeholder}}
\newcommand{\DEph}{\DE{German text placeholder}}
\newcommand{\THAph}{\THA{Thai text placeholder}}
\newcommand{\NLph}{\NL{Dutch text placeholder}}

\newcommand{\TITLE}{%
	\RU{Reverse Engineering для начинающих}%
	\EN{Reverse Engineering for Beginners}%
	\ES{Ingenier\'ia Inversa para Principiantes}%
	\PTBRph{}%
	\DEph{}\PLph{}%
	\ITAph{}%
	\THAph{}\NLph{}%
}

\ifdefined\RUSSIAN
\newcommand{\AUTHOR}{Денис Юричев}
\else
\newcommand{\AUTHOR}{Dennis Yurichev}
\fi

\newcommand{\EMAIL}{dennis(a)yurichev.com}

\newcommand*{\dittoclosing}{---''---}
\newcommand*{\EMDASH}{\RU{~--- }\EN{---}\ES{---}\PTBR{---}\PL{---}\ITA{---}\DE{---}\THA{---}\NL{---}}
\newcommand*{\AsteriskOne}{${}^{*}$}
\newcommand*{\AsteriskTwo}{${}^{**}$}
\newcommand*{\AsteriskThree}{${}^{***}$}
\newcommand{\q}[1]{\enquote{#1}}
\newcommand{\var}[1]{\textit{#1}}

\newcommand{\ttf}{\GTT{f()}\xspace}
\newcommand{\ttfone}{\GTT{f1()}\xspace}

% FIXME get rid of
% without dot!
\newcommand{\etc}{%
	\RU{и~т.д}%
	\EN{etc}%
	\ES{etc}%
	\PTBRph{}%
	\PLph{}%
	\ITAph{}%
	\DEph{}%
	\THAph{}%
	\NLph{}%
}

% http://tex.stackexchange.com/questions/32160/new-line-after-paragraph
\newcommand{\myparagraph}[1]{\paragraph{#1}\mbox{}\\} 

\newcommand{\figname}{%
	\RU{илл.}%
	\EN{fig.}%
	\ES{fig.}%
	\PTBRph{}%
	\PLph{}%
	\ITAph{}%
	\DEph{}%
	\THAph{}%
	\NLph{}%
\xspace}
\newcommand{\figref}[1]{\figname{}\ref{#1}\xspace}
\newcommand{\listingname}{%
	\RU{листинг.}%
	\EN{listing.}%
	\ES{listado.}%
	\PTBRph{}%
	\PLph{}%
	\ITAph{}%
	\DEph{}%
	\THAph{}%
	\NLph{}%
\xspace}
\newcommand{\lstref}[1]{\listingname{}\ref{#1}\xspace}
\newcommand{\bitENRU}{%
	\RU{бит}%
	\EN{bit}%
	\ES{bit}%
	\PTBRph{}%
	\PLph{}%
	\ITAph{}%
	\DEph{}%
	\THAph{}%
	\NLph{}%
\xspace}
% FIXME get rid of:
\newcommand{\bitsENRU}{%
	\RU{бита}%
	\EN{bits}%
	\ES{bits}%
	\PTBRph{}%
	\PLph{}%
	\ITAph{}%
	\DEph{}%
	\THAph{}%
	\NLph{}%
\xspace}
\newcommand{\Sourcecode}{%
	\RU{Исходный код}%
	\EN{Source code}%
	\ES{C\'odigo fuente}%
	\PTBRph{}%
	\PLph{}%
	\ITAph{}%
	\DEph{}%
	\THAph{}%
	\NLph{}%
\xspace}
\newcommand{\Seealso}{%
	\RU{См. также}%
	\EN{See also}%
	\ES{V\'ease tambi\'en}%
	\PTBRph{}%
	\PLph{}%
	\ITAph{}%
	\DEph{}%
	\THAph{}%
	\NLph{}%
\xspace}
\newcommand{\MacOSX}{Mac OS X\xspace}

% FIXME TODO non-overlapping color!
% \newcommand{\headercolor}{\cellcolor{blue!25}}
\newcommand{\headercolor}{}

\newcommand{\tableheader}{\headercolor{}%
	\RU{смещение}%
	\EN{offset}%
	\ES{offset}%
	\PLph{}%
	\ITAph{}%
	\DEph{}%
	\THAph{}%
	\NLph{}%
& \headercolor{}%
	\RU{описание}%
	\EN{description}%
	\ES{descripci\'on}%
	\PTBRph{}%
	\PLph{}%
	\ITAph{}%
	\DEph{}%
	\THAph{}%
	\NLph{}%
}

\newcommand{\IDA}{\ac{IDA}\xspace}

\newcommand{\tracer}{\protect\gls{tracer}\xspace}

\newcommand{\Tchar}{\IT{char}\xspace} 
\newcommand{\Tint}{\IT{int}\xspace}
\newcommand{\Tbool}{\IT{bool}\xspace}
\newcommand{\Tfloat}{\IT{float}\xspace}
\newcommand{\Tdouble}{\IT{double}\xspace}
\newcommand{\Tvoid}{\IT{void}\xspace}
\newcommand{\ITthis}{\IT{this}\xspace}

\newcommand{\Ox}{\GTT{/Ox}\xspace}
\newcommand{\Obzero}{\GTT{/Ob0}\xspace}
\newcommand{\Othree}{\GTT{-O3}\xspace}

\newcommand{\oracle}{Oracle RDBMS\xspace}

\newcommand{\idevices}{iPod/iPhone/iPad\xspace}
\newcommand{\olly}{OllyDbg\xspace}

% common C functions
\newcommand{\printf}{\GTT{printf()}\xspace} 
\newcommand{\puts}{\GTT{puts()}\xspace} 
\newcommand{\main}{\GTT{main()}\xspace} 
\newcommand{\qsort}{\GTT{qsort()}\xspace} 
\newcommand{\strlen}{\GTT{strlen()}\xspace} 
\newcommand{\scanf}{\GTT{scanf()}\xspace} 
\newcommand{\rand}{\GTT{rand()}\xspace} 


% for easier fiddling with formatting of all instructions together
\newcommand{\INS}[1]{\GTT{#1}\xspace}

% x86 instructions
\newcommand{\ADD}{\INS{ADD}}
\newcommand{\ADRP}{\INS{ADRP}}
\newcommand{\AND}{\INS{AND}}
\newcommand{\CALL}{\INS{CALL}}
\newcommand{\CPUID}{\INS{CPUID}}
\newcommand{\CMP}{\INS{CMP}}
\newcommand{\DEC}{\INS{DEC}}
\newcommand{\FADDP}{\INS{FADDP}}
\newcommand{\FCOM}{\INS{FCOM}}
\newcommand{\FCOMP}{\INS{FCOMP}}
\newcommand{\FCOMI}{\INS{FCOMI}}
\newcommand{\FCOMIP}{\INS{FCOMIP}}
\newcommand{\FUCOM}{\INS{FUCOM}}
\newcommand{\FUCOMI}{\INS{FUCOMI}}
\newcommand{\FUCOMIP}{\INS{FUCOMIP}}
\newcommand{\FUCOMPP}{\INS{FUCOMPP}}
\newcommand{\FDIVR}{\INS{FDIVR}}
\newcommand{\FDIV}{\INS{FDIV}}
\newcommand{\FLD}{\INS{FLD}}
\newcommand{\FMUL}{\INS{FMUL}}
\newcommand{\MUL}{\INS{MUL}}
\newcommand{\FSTP}{\INS{FSTP}}
\newcommand{\FDIVP}{\INS{FDIVP}}
\newcommand{\IDIV}{\INS{IDIV}}
\newcommand{\IMUL}{\INS{IMUL}}
\newcommand{\INC}{\INS{INC}}
\newcommand{\JAE}{\INS{JAE}}
\newcommand{\JA}{\INS{JA}}
\newcommand{\JBE}{\INS{JBE}}
\newcommand{\JB}{\INS{JB}}
\newcommand{\JE}{\INS{JE}}
\newcommand{\JGE}{\INS{JGE}}
\newcommand{\JG}{\INS{JG}}
\newcommand{\JLE}{\INS{JLE}}
\newcommand{\JL}{\INS{JL}}
\newcommand{\JMP}{\INS{JMP}}
\newcommand{\JNE}{\INS{JNE}}
\newcommand{\JNZ}{\INS{JNZ}}
\newcommand{\JNA}{\INS{JNA}}
\newcommand{\JNAE}{\INS{JNAE}}
\newcommand{\JNB}{\INS{JNB}}
\newcommand{\JNBE}{\INS{JNBE}}
\newcommand{\JZ}{\INS{JZ}}
\newcommand{\JP}{\INS{JP}}
\newcommand{\Jcc}{\INS{Jcc}}
\newcommand{\SETcc}{\INS{SETcc}}
\newcommand{\LEA}{\INS{LEA}}
\newcommand{\LOOP}{\INS{LOOP}}
\newcommand{\MOVSX}{\INS{MOVSX}}
\newcommand{\MOVZX}{\INS{MOVZX}}
\newcommand{\MOV}{\INS{MOV}}
\newcommand{\NOP}{\INS{NOP}}
\newcommand{\POP}{\INS{POP}}
\newcommand{\PUSH}{\INS{PUSH}}
\newcommand{\NOT}{\INS{NOT}}
\newcommand{\NOR}{\INS{NOR}}
\newcommand{\RET}{\INS{RET}}
\newcommand{\RETN}{\INS{RETN}}
\newcommand{\SETNZ}{\INS{SETNZ}}
\newcommand{\SETBE}{\INS{SETBE}}
\newcommand{\SETNBE}{\INS{SETNBE}}
\newcommand{\SUB}{\INS{SUB}}
\newcommand{\TEST}{\INS{TEST}}
\newcommand{\TST}{\INS{TST}}
\newcommand{\FNSTSW}{\INS{FNSTSW}}
\newcommand{\SAHF}{\INS{SAHF}}
\newcommand{\XOR}{\INS{XOR}}
\newcommand{\OR}{\INS{OR}}
\newcommand{\SHL}{\INS{SHL}}
\newcommand{\SHR}{\INS{SHR}}
\newcommand{\SAR}{\INS{SAR}}
\newcommand{\LEAVE}{\INS{LEAVE}}
\newcommand{\MOVDQA}{\INS{MOVDQA}}
\newcommand{\MOVDQU}{\INS{MOVDQU}}
\newcommand{\PADDD}{\INS{PADDD}}
\newcommand{\PCMPEQB}{\INS{PCMPEQB}}
\newcommand{\LDR}{\INS{LDR}}
\newcommand{\LSL}{\INS{LSL}}
\newcommand{\LSR}{\INS{LSR}}
\newcommand{\ASR}{\INS{ASR}}
\newcommand{\RSB}{\INS{RSB}}
\newcommand{\BTR}{\INS{BTR}}
\newcommand{\BTS}{\INS{BTS}}
\newcommand{\BTC}{\INS{BTC}}
\newcommand{\LUI}{\INS{LUI}}
\newcommand{\ORI}{\INS{ORI}}
\newcommand{\BIC}{\INS{BIC}}
\newcommand{\EOR}{\INS{EOR}}
\newcommand{\MOVS}{\INS{MOVS}}
\newcommand{\LSLS}{\INS{LSLS}}
\newcommand{\LSRS}{\INS{LSRS}}
\newcommand{\FMRS}{\INS{FMRS}}
\newcommand{\CMOVNE}{\INS{CMOVNE}}
\newcommand{\CMOVNZ}{\INS{CMOVNZ}}
\newcommand{\ROL}{\INS{ROL}}
\newcommand{\CSEL}{\INS{CSEL}}
\newcommand{\SLL}{\INS{SLL}}
\newcommand{\SLLV}{\INS{SLLV}}
\newcommand{\SW}{\INS{SW}}
\newcommand{\LW}{\INS{LW}}

% x86 flags

\newcommand{\ZF}{\GTT{ZF}\xspace} 
\newcommand{\CF}{\GTT{CF}\xspace} 
\newcommand{\PF}{\GTT{PF}\xspace} 

% x86 registers

\newcommand{\AL}{\GTT{AL}\xspace} 
\newcommand{\AH}{\GTT{AH}\xspace} 
\newcommand{\AX}{\GTT{AX}\xspace} 
\newcommand{\EAX}{\GTT{EAX}\xspace} 
\newcommand{\EBX}{\GTT{EBX}\xspace} 
\newcommand{\ECX}{\GTT{ECX}\xspace} 
\newcommand{\EDX}{\GTT{EDX}\xspace} 
\newcommand{\DL}{\GTT{DL}\xspace} 
\newcommand{\ESI}{\GTT{ESI}\xspace} 
\newcommand{\EDI}{\GTT{EDI}\xspace} 
\newcommand{\EBP}{\GTT{EBP}\xspace} 
\newcommand{\ESP}{\GTT{ESP}\xspace} 
\newcommand{\RSP}{\GTT{RSP}\xspace} 
\newcommand{\EIP}{\GTT{EIP}\xspace} 
\newcommand{\RIP}{\GTT{RIP}\xspace} 
\newcommand{\RAX}{\GTT{RAX}\xspace} 
\newcommand{\RBX}{\GTT{RBX}\xspace} 
\newcommand{\RCX}{\GTT{RCX}\xspace} 
\newcommand{\RDX}{\GTT{RDX}\xspace} 
\newcommand{\RBP}{\GTT{RBP}\xspace} 
\newcommand{\RSI}{\GTT{RSI}\xspace} 
\newcommand{\RDI}{\GTT{RDI}\xspace} 
\newcommand*{\ST}[1]{\GTT{ST(#1)}\xspace}
\newcommand*{\XMM}[1]{\GTT{XMM#1}\xspace}

% ARM
\newcommand*{\Reg}[1]{\GTT{R#1}\xspace}
\newcommand*{\RegX}[1]{\GTT{X#1}\xspace}
\newcommand*{\RegW}[1]{\GTT{W#1}\xspace}
\newcommand*{\RegD}[1]{\GTT{D#1}\xspace}
\newcommand{\ADREQ}{\GTT{ADREQ}\xspace}
\newcommand{\ADRNE}{\GTT{ADRNE}\xspace}
\newcommand{\BEQ}{\GTT{BEQ}\xspace}

% instructions descriptions
\newcommand{\ASRdesc}{%
	\RU{арифметический сдвиг вправо}%
	\EN{arithmetic shift right}%
	\ES{desplazamiento aritm\'etico a la derecha}%
	\PTBRph{}%
	\PLph{}%
	\ITAph{}%
	\DEph{}%
	\THAph{}\NLph{}%
}

% x86 registers tables
\newcommand{\RegHeaderTop}{
	\multicolumn{8}{ | c | }{
	\RU{Номер байта:}
	\EN{Byte number:}
	\ES{}%
	\PTBRph{}%
	\PLph{}%
	\ITAph{}%
	\DEph{}%
	\THAph{}%
	\NLph{}%
	}
}

% TODO: non-overlapping color!
\newcommand{\RegHeader}{
\RU{ 7-й & 6-й & 5-й & 4-й & 3-й & 2-й & 1-й & 0-й }%
\EN{ 7th & 6th & 5th & 4th & 3rd & 2nd & 1st & 0th }%
\ES{ 7mo & 6to & 5to & 4to & 3ro & 2do & 1ro & 0 }%
\PTBRph{}%
\PLph{}%
\ITAph{}%
\DEph{}%
\THAph{}%
\NLph{}%
}

% FIXME навести порядок тут...
\newcommand{\RegTableThree}[5]{
\begin{center}
\begin{tabular}{ | l | l | l | l | l | l | l | l | l |}
\hline
\RegHeaderTop \\
\hline
\RegHeader \\
\hline
\multicolumn{8}{ | c | }{#1} \\
\hline
\multicolumn{4}{ | c | }{} & \multicolumn{4}{ c | }{#2} \\
\hline
\multicolumn{6}{ | c | }{} & \multicolumn{2}{ c | }{#3} \\
\hline
\multicolumn{6}{ | c | }{} & #4 & #5 \\
\hline
\end{tabular}
\end{center}
}

\newcommand{\RegTableOne}[5]{\RegTableThree{#1\textsuperscript{x64}}{#2}{#3}{#4}{#5}}

\newcommand{\RegTableTwo}[4]{
\begin{center}
\begin{tabular}{ | l | l | l | l | l | l | l | l | l |}
\hline
\RegHeaderTop \\
\hline
\RegHeader \\
\hline
\multicolumn{8}{ | c | }{#1\textsuperscript{x64}} \\
\hline
\multicolumn{4}{ | c | }{} & \multicolumn{4}{ c | }{#2} \\
\hline
\multicolumn{6}{ | c | }{} & \multicolumn{2}{ c | }{#3} \\
\hline
\multicolumn{7}{ | c | }{} & #4\textsuperscript{x64} \\
\hline
\end{tabular}
\end{center}
}

\newcommand{\RegTableFour}[4]{
\begin{center}
\begin{tabular}{ | l | l | l | l | l | l | l | l | l |}
\hline
\RegHeaderTop \\
\hline
\RegHeader \\
\hline
\multicolumn{8}{ | c | }{#1} \\
\hline
\multicolumn{4}{ | c | }{} & \multicolumn{4}{ c | }{#2} \\
\hline
\multicolumn{6}{ | c | }{} & \multicolumn{2}{ c | }{#3} \\
\hline
\multicolumn{7}{ | c | }{} & #4 \\
\hline
\end{tabular}
\end{center}
}

