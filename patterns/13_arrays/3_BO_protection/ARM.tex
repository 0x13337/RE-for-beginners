\subsection{\OptimizingXcodeIV (\ThumbTwoMode)}

\RU{Возвращаясь к нашему простому примеру}\EN{Let's back to our simple array example}~(\ref{arrays_simple}),
\RU{можно посмотреть, как LLVM добавит проверку ``канарейки''}
\EN{again, now we can see how LLVM will check ``canary'' correctness}:

\lstinputlisting{patterns/13_arrays/3_BO_protection/simple_Xcode_thumb_O3_\LANG.asm}

\index{Unrolled loop}
\RU{Во-первых, как видно, LLVM ``развернул'' цикл и все значения записываются в массив по одному, 
уже вычисленные, 
потому что LLVM посчитал что так будет быстрее.}
\EN{First of all, as we see, LLVM made loop ``unrolled'' and all values are written into array one-by-one,
already calculated since LLVM concluded it will be faster.}
\RU{Кстати, инструкции режима ARM позволяют сделать это еще быстрее и это может быть вашим 
домашним заданием.}\EN{By the way, ARM mode instructions may help to do this even faster, 
and finding this way could be your homework.}

\RU{В конце функции мы видим сравнение ``канареек'' ~--- той что лежит в локальном стеке и корректной, 
на которую ссылается регистр \Reg{8}.}
\EN{At the function end wee see ``canaries'' comparison~---that laying in local stack and correct one,
to which the \Reg{8} register pointing.}
\index{ARM!\Instructions!IT}
\RU{Если они равны, срабатывает блок из четырех инструкций при помощи \TT{``ITTTT EQ''}, это запись
$0$ в \Reg{0}, эпилог функции и выход из нее.}
\EN{If they are equal to each other, 4-instruction block is triggered by \TT{``ITTTT EQ''}, it is
writing $0$ into \Reg{0}, function epilogue and exit.}
\RU{Если ``канарейки'' не равны, блок не срабатывает и происходит
переход на функцию}\EN{If ``canaries'' are not equal, block will not be triggered,
and jump to} \TT{\_\_\_stack\_chk\_fail}\RU{, которая, вероятно, остановит работу программы.}
\EN{ function will be occurred, which, as I suppose, will halt execution.}
% TODO illustrate this!
